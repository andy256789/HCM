<div class="employees-page">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-info">
        <h1 class="page-title">Employee Directory</h1>
        <p class="page-description">Manage your organization's workforce and employee information</p>
      </div>
      <div class="header-stats">
        <div class="stat-item">
          <span class="stat-value">{{employees.length}}</span>
          <span class="stat-label">Total Employees</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{departments.length}}</span>
          <span class="stat-label">Departments</span>
        </div>
      </div>
    </div>
    <button class="primary-btn" *ngIf="canEdit()" (click)="showAddForm()">
      <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
      </svg>
      <span>Add Employee</span>
    </button>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading employee data...</p>
    </div>
  </div>

  <!-- Employee Form Modal -->
  <div class="modal-overlay" *ngIf="showForm" (click)="cancelForm()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">{{ editingEmployee ? 'Edit Employee' : 'Add New Employee' }}</h2>
        <button class="modal-close" (click)="cancelForm()" type="button">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
      </div>
      
      <form [formGroup]="employeeForm" (ngSubmit)="saveEmployee()" class="employee-form">
        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">First Name</label>
            <input type="text" formControlName="firstName" class="form-input" placeholder="Enter first name">
            <div class="form-error" *ngIf="employeeForm.get('firstName')?.hasError('required') && employeeForm.get('firstName')?.touched">
              First name is required
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Last Name</label>
            <input type="text" formControlName="lastName" class="form-input" placeholder="Enter last name">
            <div class="form-error" *ngIf="employeeForm.get('lastName')?.hasError('required') && employeeForm.get('lastName')?.touched">
              Last name is required
            </div>
          </div>

          <div class="form-group form-group-full">
            <label class="form-label">Email Address</label>
            <input type="email" formControlName="email" class="form-input" placeholder="Enter email address">
            <div class="form-error" *ngIf="employeeForm.get('email')?.hasError('required') && employeeForm.get('email')?.touched">
              Email is required
            </div>
            <div class="form-error" *ngIf="employeeForm.get('email')?.hasError('email') && employeeForm.get('email')?.touched">
              Please enter a valid email address
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Job Title</label>
            <input type="text" formControlName="jobTitle" class="form-input" placeholder="Enter job title">
            <div class="form-error" *ngIf="employeeForm.get('jobTitle')?.hasError('required') && employeeForm.get('jobTitle')?.touched">
              Job title is required
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Department</label>
            <select formControlName="departmentId" class="form-select">
              <option value="">Select a department</option>
              <option *ngFor="let department of departments" [value]="department.id">
                {{ department.name }}
              </option>
            </select>
            <div class="form-error" *ngIf="employeeForm.get('departmentId')?.hasError('required') && employeeForm.get('departmentId')?.touched">
              Department is required
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Annual Salary</label>
            <div class="input-with-prefix">
              <span class="input-prefix">$</span>
              <input type="number" formControlName="salary" class="form-input" placeholder="0" min="0">
            </div>
            <div class="form-error" *ngIf="employeeForm.get('salary')?.hasError('required') && employeeForm.get('salary')?.touched">
              Salary is required
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="secondary-btn" (click)="cancelForm()">Cancel</button>
          <button type="submit" class="primary-btn" [disabled]="!employeeForm.valid || loading">
            <span *ngIf="!loading">{{ editingEmployee ? 'Update Employee' : 'Add Employee' }}</span>
            <span *ngIf="loading">{{ editingEmployee ? 'Updating...' : 'Adding...' }}</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content" *ngIf="!showForm">
    <!-- Search and Filters -->
    <div class="content-header">
      <div class="search-container">
        <div class="search-input-wrapper">
          <svg class="search-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
          <input type="text" (keyup)="applyFilter($event)" class="search-input" placeholder="Search by name, email, job title, or department...">
        </div>
      </div>
      
      <div class="view-options">
        <span class="results-count">{{ filteredEmployees.length }} of {{ employees.length }} employees</span>
      </div>
    </div>

    <!-- Employee Grid -->
    <div class="employees-container" *ngIf="employees.length > 0">
      <div class="employees-grid">
        <div class="employee-card" *ngFor="let employee of filteredEmployees">
          <div class="card-header">
            <div class="employee-avatar">
              <span class="avatar-initials">{{ getInitials(employee.fullName) }}</span>
            </div>
            <div class="card-actions" *ngIf="canEdit() || canDelete()">
              <button class="action-btn edit" *ngIf="canEdit()" (click)="editEmployee(employee)" title="Edit Employee">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                </svg>
              </button>
              <button class="action-btn delete" *ngIf="canDelete()" (click)="deleteEmployee(employee)" title="Delete Employee">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                </svg>
              </button>
            </div>
          </div>
          
          <div class="card-content">
            <h3 class="employee-name">{{ employee.fullName }}</h3>
            <p class="employee-title">{{ employee.jobTitle }}</p>
            
            <div class="employee-details">
              <div class="detail-row">
                <svg class="detail-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-4h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"/>
                </svg>
                <span class="detail-text">{{ employee.departmentName }}</span>
              </div>
              
              <div class="detail-row">
                <svg class="detail-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                </svg>
                <span class="detail-text">{{ employee.email }}</span>
              </div>
              
              <div class="detail-row salary-row">
                <svg class="detail-icon" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/>
                </svg>
                <span class="detail-text salary-amount">{{ employee.salary | currency:'USD':'symbol':'1.0-0' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="employees.length === 0 && !loading">
      <div class="empty-illustration">
        <svg viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="60" cy="60" r="60" fill="#f8fafc"/>
          <circle cx="60" cy="45" r="15" fill="#e2e8f0"/>
          <path d="M30 85c0-16.569 13.431-30 30-30s30 13.431 30 30" stroke="#e2e8f0" stroke-width="2"/>
        </svg>
      </div>
      <h3 class="empty-title">No Employees Yet</h3>
      <p class="empty-description">Start building your team by adding your first employee to the directory.</p>
      <button class="primary-btn" *ngIf="canEdit()" (click)="showAddForm()">
        <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </svg>
        <span>Add First Employee</span>
      </button>
    </div>

    <!-- No Search Results -->
    <div class="empty-state" *ngIf="employees.length > 0 && filteredEmployees.length === 0">
      <div class="empty-illustration">
        <svg viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="60" cy="60" r="60" fill="#f8fafc"/>
          <circle cx="55" cy="55" r="20" stroke="#e2e8f0" stroke-width="2"/>
          <path d="71 71l15 15" stroke="#e2e8f0" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </div>
      <h3 class="empty-title">No Results Found</h3>
      <p class="empty-description">Try adjusting your search criteria to find the employees you're looking for.</p>
    </div>
  </div>
</div>
